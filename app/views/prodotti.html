<div ng-controller="prodottiCtrl">

  <div class="title">
    <h5>Prodotti</h5>
  </div>
  <br>
  <nav id="searchBar">
 <div class="nav-wrapper">
      <form>
        <div class="input-field">
          <input id="search" type="search" placeholder="ricerca i tuoi prodotti" ng-model="search" required>
          <label class="label-icon" for="search"><i class="material-icons">search</i></label>
          <i class="material-icons">close</i>
        </div>
      </form>
    </div>
  </nav>
  <div class="row">

    <ul class="collapsible" id="pannelloAggiungi">
      <li>
        <div class="collapsible-header ">
          <i class="material-icons">add</i>Aggiungi un prodotto</div>
        <div class="col s12 m6 l12 collapsible-body">
          <div class="card-panel #fff8e1 amber lighten-5">
            <div class="row">
              <form class="col s12" ng-submit="aggiungiProdotto(nuovoProdotto)">
                <div class="row">
                  <div class="input-field col s2">
                    <input id="nome_prodotto" type="text" class="validate" ng-model="nuovoProdotto.nome">
                    <label for="first_name">Nome Prodotto</label>
                  </div>
                  <div class="input-field col s6">
                    <textarea id="textarea1" class="materialize-textarea" ng-model="nuovoProdotto.descrizione"></textarea>
                    <label for="textarea1">Descrizione</label>
                  </div>


                  <div class="file-field input-field col s3">
                    <div class="btn">
                      <span>File</span>
                      <input type="file" multiple>
                    </div>
                    <div class="file-path-wrapper">
                      <input class="file-path validate" type="text" placeholder="inserisci documento">
                    </div>
                  </div>
                  <div class="input-field col s1">
                    <input id="prezzo" type="number" step="0.01" min="1" class="validate" ng-model="nuovoProdotto.prezzo">
                    <label for="prezzo">Prezzo</label>
                  </div>
                </div>
                <div class="row">

                  <div class="input-field col s3">

                    <button class="btn waves-effect waves-light #64dd17 light-green accent-4" type="submit" name="action">Aggiungi
                      <i class="material-icons right">send</i>
                    </button>

                  </div>

                </div>

              </form>

            </div>
          </div>
        </div>
      </li>

    </ul>


  </div>

  <div class="row">
    <div class="col s12 m11">

      <table>
        <thead>
          <tr>
            <th>Codice Prodotto</th>
            <th>Nome Prodotto</th>
            <th>Descrizione Prodotto</th>
            <th>Prezzo Prodotto</th>
            <th></th>
          </tr>
        </thead>

        <tbody>
          <tr ng-repeat="prodotto in prodotti | filter:search ">
            <td>{{prodotto._id}}</td>
            <td>{{prodotto.nome}}</td>
            <td>{{prodotto.descrizione}}</td>
            <td>{{prodotto.prezzo}} â‚¬</td>
            <td>
              <a ng-click="eliminaProdotto(prodotto._id)" class="task-remove btn-floating waves-effect waves-light red gradient-shadow">
                <i class="material-icons">delete</i>
              </a>
              <a ng-click="idProdottoDaModificare(prodotto._id)" data-target="modal" class="btn-floating modal-trigger waves-effect waves-light orange gradient-shadow">
                <i class="material-icons">create</i>
              </a>

            </td>

          </tr>
        </tbody>
      </table>


      <!-- modal per la modifica del prodotto, questa struttura deve essere fuori dalla parte principale di codice -->
      <div id="modal" class="modal">
        <div class="modal-content">
          <h4>Modifica Prodotto</h4>
          <!-- FORM modifica -->
          <div class="row">
            <form class="col s12" ng-submit="modificaProdotto(questoProdotto)">
              <div class="row">
                <div class="input-field col s2">
                  <input id="nome_prodotto" type="text" class="validate" ng-model="questoProdotto.nome">
                  <label for="first_name">Nome Prodotto</label>
                </div>
                <div class="input-field col s6">
                  <textarea id="textarea1" class="materialize-textarea" ng-model="questoProdotto.descrizione"></textarea>
                  <label for="textarea1">Descrizione</label>
                </div>


                <div class="file-field input-field col s3">
                  <div class="btn">
                    <span>File</span>
                    <input type="file" multiple>
                  </div>
                  <div class="file-path-wrapper">
                    <input class="file-path validate" type="text" placeholder="inserisci documento">
                  </div>
                </div>
                <div class="input-field col s1">
                  <input id="prezzo" type="number" step="0.01" min="1" class="validate" ng-model="questoProdotto.prezzo">
                  <label for="prezzo">Prezzo</label>
                </div>
              </div>
              <div class="row">

                <div class="input-field col s3">

                  <button class="btn waves-effect waves-light #64dd17 light-green accent-4" type="submit" name="action">Modifica
                    <i class="material-icons right">send</i>
                  </button>

                </div>

              </div>

            </form>

          </div>
        </div>
        <div class="modal-footer">
          <a class="modal-action modal-close waves-effect waves-green btn-flat">Chiudi</a>
        </div>
      </div>


    </div>
  </div>


</div>

<script>
  $('.collapsible').collapsible();
  $('.modal').modal();
</script>